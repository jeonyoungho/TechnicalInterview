# Kafka - 면접 대비

### Q. Kafka는 왜 만들어졌나요?
- 링크드인에서 개발되었는데 데이터 파이프라인을 구축하는데 있어 기존의 메시지 큐 시스템을 활용하기엔 데이터 파편화가 발생한다는 단점이 있었다. 이는 유지 보수의 어려움으로 이어졌고 이를 극복하기 위해 만들어졌다. 카프카는 데이터를 중앙 집중화해서 처리한다. 기업의 대용량 데이터를 수집하고 사용자들이 실시간 스트림으로 소비할 수 있도록 만들어졌습니다.

### Q. 카프카가 다른 메시지 큐 시스템과 다른점
- 데이터를 가져가더라도 데이터가 사라지지 않기 때문에 여러 컨슈머 그룹을 통해 다양하게 활용할 수 있음

### Q. 카프카와 Rabbit MQ의 차이점
- Rabbit MQ는 브로커가 컨슈머에 데이터를 보내는 방식인데
- Kafka는 컨슈머가 브로커에서 데이터를 가져가는 방식이기에 유연하게 데이터를 처리할 수 있음

### Q. Kafka는 어떻게 고가용성을 유지하는가?
- 1)컨슈머 그룹이 읽은 파티션의 옵셋을 _consumer_offsets토픽에 별도로 저장하고 있기에 특정 컨슈머가 중단되었다가 다시 시작해도 다음 읽을 데이터부터 정확하게 읽어처리 할 수 있다.
- 2)Producer의 ack옵션을 0, 1, all을 지정하여 broker서버에 정상적으로 데이터가 전송돼고 복제됐는지를 확인 할 수 있다.
- 3)Zookeeper가 여러 브로커서버들을 관리하면서 Leader 파티션에 장애가 생겼을 경우 Follower Partition중 하나를 선택하여 Leader 파티션의 역할을 승계하도록 한다. 이로 인해 데이터의 유실을 방지한다.

### Q. Leader 파티션과 Follower파티션의 차이는 무엇인가?
- Leader 파티션은 프로듀서로 부터 실제로 데이터를 받아 처리하는 파티션입니다. Follower파티션은 Leader 파티션의 데이터를 복제하는 역할을 합니다.

### Q. Consumer의 개수는 어떻게 설정해야하는가?
- Consumer의 개수는 특정 Topic의 Partion의 개수보다 적거나 같게 설정해야합니다.
- Consumer는 하나의 Partion에만 접근할 수 있기에 Consumer의 개수가 Partion의 개수보다 더 많아진다해도 메모리만 낭비되고 분산 처리의 효과가 없게 된다. (할당 안된 컨슈머는 동작하지 않고 메모리만 낭비하게 된다.)

### Q. Consumer Group의 역할은 무엇인가요?
- 각 Consumer Group은 옵셋을 서로 영향을 주지 않기에 데이터를 다양하게 활용하여 사용할 수 있습니다.

### Q. 왜 카프카의 장점은 무엇인가요?
- 첫번째는, 높은 메시지 처리량입니다. 파티션을 통한 분산 처리가 가능하기에 데이터양이 많아질수록 컨슈머 갯수를 늘려 병렬로 데이터 처리를 빠르게 할 수 있습니다.
- 두번째는, 뛰어난 확장성과 장애복구 기능입니다. 브로커 서버의 수평적인 확장이 가능하며 브로커 중 몇 대가 죽더라도 replaction기능을 통해 안전하게 데이터를 복구할 수 있습니다.
- 세번째는, 데이터의 보존입니다. 다른 메시지 큐 시스템과 달리 데이터를 컨슈머가 가져가더라도 데이터를 삭제하지 않기에 다양하게 활용할 수 있기 때문입니다.

### Q. 카프카 Lag은 무엇인가요?
- 컨슈머가 읽은 옵셋과 프로듀서과 전송한 데이터의 옵셋 간의 차이입니다. 카프카의 성능을 측정하는 지표가 되고 오픈 소스인 Burrow를 통해 모니터링할 수 있습니다. Lag은 파티션마다 존재하게 됩니다.

